pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
	--printh("******")
	circle = {
		pos = {x=64, y=64}, 
		rad = 24, 
		pts = 16, 
		st_deg = 0, end_deg = 360
	}
	enemies = rnd_pts(64)
end

function _update()
	move_circle()
	flag_collisions()
end

function _draw()
	cls()
	draw_circle(circle)
	draw_pts(enemies)
end
-->8
function move_circle()
	if (btn(0) and circle.pos.x > 0) circle.pos.x -= 1
	if (btn(1) and circle.pos.x < 127) circle.pos.x += 1
	if (btn(2) and circle.pos.y > 0) circle.pos.y -= 1
	if (btn(3) and circle.pos.y < 127) circle.pos.y += 1
end

function flag_collisions()
	for k,enm in pairs(enemies) do
		enm["col"] = is_pt_circ_col(enm.pos, circle)
	end
end

function rnd_pts(cnt)
	local pts = {}
	for i = 0, cnt do
		local pos = {
			x = flr(rnd(129)),
			y = flr(rnd(129))
		}
		add(pts, {pos = pos})
	end

	return pts
end

function is_pt_circ_col(pt, circle)
	local d_x = circle.pos.x - pt.x
	local d_y = circle.pos.y - pt.y
	local dst = sqrt((d_x * d_x) + (d_y * d_y))

	return dst <= circle.rad
end
-->8
function draw_pts(pts)
	for k,pt in pairs(pts) do
		local rnd_col_id = flr(rnd(4)) + 1
		local col_id = pt["col"] == true and 8 or rnd_col_id -- col_id = pt['col'] ? 8 : rnd_col_id

		pset(pt.pos.x, pt.pos.y, col_id)
	end
end

function draw_circle(attr)
	color(15)
	line(attr.pos.x + attr.rad, attr.pos.y, 
			 attr.pos.x + attr.rad, attr.pos.y)
	
	local pts = arc_pts(attr)
	for k, pt in pairs(pts) do
		line(attr.pos.x + pt.x, 
				attr.pos.y + pt.y)
	end
end
-->8
function deg_to_tau(deg)
	return deg / 360
end

function arc_pts(attr)
	local pts = {}
	local theta = deg_to_tau(attr.st_deg)
	local arc_stride = (attr.end_deg - attr.st_deg) / attr.pts

	for i = 0, attr.pts do
		local pt = {
				x = attr.rad * cos(theta), 
				y = attr.rad * sin(theta)
		}

		add(pts, pt)
		theta += deg_to_tau(arc_stride)
	  -- printh(pt.x.." "..pt.y)
	end

	return pts
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000300000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000
00000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000
00000000000000000000000001000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000
10000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000040000000000000000001000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000ffffffffff00000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000fffff0000000000fffff000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000f00000000008000000000f00000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000f0000000000000000000000f0000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000ff000000000000000000000000ff00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000f0000000000000000000080000080f0000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000f000000000000000000000000000000f000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000f00000000000000000000000000000000f00000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000f0000000000000000000000000000000000f0000000040000000000000000000000000000000000000
000000010000000000000000000000000000000000000f000000000000000000000000000000000000f000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000f00000000000000000000000000000000000000f00000000000000000000000000400000000000000000
00000000000000000000000000020000000000000000f00000000000000000000000000000000000000f00000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000f0000000000000000000000000000000000000000f0000000000000000000000000000000000000000000
000000000000000000000000000000000000000000f000000000000000000000000000000000000000000f000000000000000000000000000000000000000000
00000000000000000000000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000000000
00000000000000000000000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000000000
00000000004000000000000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000000000
00000000000000000000000000000000000000000f000000000000000000000000000000000000000000000f0000000000000000000000000000040000000000
00000000000000000000000000000000000000000f000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
02000000000000000000000000000000000000000f000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
0000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
0000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
0000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000f000000000000000000000000000000000000000
0000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000f000000000000000000000000000000000000000
0000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000f000000000000000000000000000000000000000
0000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000f000000000000000000000000000000000000000
0000000100000000000000000000000000000000f00000000000000000000000000000000000000000000000f000000000000000000000000000000000000000
0000000400000000000000000000000000000000f0000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
0000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000f0000000200000000000000000000000000000000
00000000000000000000000000000000000000000f000080000000000000008000000000000000000000000f0000000000000000000000000000000000000000
00000000000000000000000000000000000000000f000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000
00000000000000000000000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000000000
00000000000000000040000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000300000
00000000000000000000000000000000000000000f00000000000000000000000000000000000000000000f00000000000000000000000000000000000000000
000000000000000000000000000000000000000000f000800000000000000000000000000000000000000f000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000f0000000000000000000000000000000000000000f0000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000f00000000000000000000000000000000000000f00000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000f00000000000000000080000000000000000000f00000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000f000000000000000000000000000000000000f000000000000000000000000000300000000000000000
0000000000000000000000010000000000000000000000f0000000000000000000000000000000000f0000000000000000000000000000000000000000030000
00000000000000000000000000000000000000000000000f00000000000000000000000000000000f00000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000f000000000000000000000000000000f000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000f0000000000000000000008000000f0000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000ff000000000000000000000000ff00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000f0000000000000000000000f0000000000000000000400000000000000000000000000000000
00000000000000000000000000000000000000000000000000000f00000000000000000000f00000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000fff00000000000000fff000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000fffff00000f8ff000000000000000000000000000000000000000000000000000000100
00000000000000000000000000000000000000000000000000000000000000fffff0000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000040000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20000000000000000000000000000000000000010000000000000000400000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

